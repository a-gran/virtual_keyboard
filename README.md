# Виртуальная клавиатура

## Описание

Приложение для визуализации нажатий клавиш в реальном времени с поддержкой английской и русской раскладок.
Реализовано с применением принципов ООП и модульной архитектуры.

## Структура проекта

```
virtual_keyboard/
├── keyboard/                   # Основной пакет приложения
│   ├── __init__.py            # Инициализация пакета
│   ├── config.py              # Конфигурация и константы
│   ├── visualizers.py         # Визуализаторы клавиатуры
│   ├── controllers.py         # Контроллеры для обработки ввода
│   ├── factory.py             # Фабрика для создания компонентов
│   ├── services.py            # Сервисы (определение языка и Caps Lock)
│   └── manager.py             # Менеджер раскладок
├── main.py                    # Точка входа в приложение
└── README.md                  # Документация
```

## Как запустить

```bash
python main.py
```

## Как остановить программу

Просто закройте окно виртуальной клавиатуры или нажмите **ESC** на клавиатуре.

## Архитектура

### Принципы ООП

Проект реализован с применением следующих принципов:

1. **Наследование**
   - `BaseKeyboardVisualizer` → `EnglishKeyboardVisualizer`, `RussianKeyboardVisualizer`
   - `BaseKeyboardController` → `EnglishKeyboardController`, `RussianKeyboardController`

2. **Инкапсуляция**
   - Конфигурация вынесена в отдельные классы (`UIConfig`, `LayoutConfig`)
   - Каждый модуль имеет четкую ответственность

3. **Полиморфизм**
   - Абстрактные методы в базовых классах
   - Различное поведение для разных языков

4. **Фабричный паттерн**
   - `KeyboardFactory` для создания компонентов по языку

5. **Принцип единственной ответственности (SRP)**
   - Каждый класс отвечает за одну конкретную задачу

### Модули

#### config.py

Конфигурация и константы:

- `Language` - Enum поддерживаемых языков
- `UIConfig` - Настройки интерфейса (цвета, шрифты, размеры)
- `KeyboardLayoutConfig` - Базовая конфигурация раскладок
- `EnglishLayoutConfig` - Английская раскладка и домашние клавиши (F, J)
- `RussianLayoutConfig` - Русская раскладка, домашние клавиши (А, О) и маппинг символов

#### visualizers.py

Визуализация клавиатуры:

- `BaseKeyboardVisualizer` - Абстрактный базовый класс
- `EnglishKeyboardVisualizer` - Визуализатор английской раскладки
- `RussianKeyboardVisualizer` - Визуализатор русской раскладки

#### controllers.py

Обработка ввода:

- `BaseKeyboardController` - Абстрактный базовый класс с поддержкой Caps Lock
- `EnglishKeyboardController` - Контроллер английской раскладки
- `RussianKeyboardController` - Контроллер с конвертацией EN→RU символов

#### factory.py

Создание компонентов:

- `KeyboardFactory` - Фабрика для создания визуализаторов и контроллеров

#### services.py

Вспомогательные сервисы:

- `LanguageDetector` - Определение текущего языка клавиатуры (Windows API)
- `CapsLockDetector` - Определение состояния Caps Lock через Windows API

#### manager.py

Управление раскладками:

- `LayoutManager` - Автоматическое переключение между раскладками с синхронизацией состояния

## Функционал

- ✅ Визуализация нажатий клавиш в реальном времени
- ✅ Поддержка английской и русской раскладок
- ✅ Автоматическое переключение при смене системной раскладки
- ✅ Подсветка домашних клавиш (F, J для EN; А, О для RU)
- ✅ Отображение набранного текста (до 50 символов)
- ✅ Полная поддержка Caps Lock с автоматической синхронизацией системного состояния
- ✅ Поддержка Shift с корректной обработкой совместно с Caps Lock
- ✅ Защита от дублирования нажатий
- ✅ Сохранение текста при переключении раскладки
- ✅ Сохранение состояния Caps Lock при переключении раскладки
- ✅ Без вложенных циклов (оптимизированный код)

## Использование виртуальной клавиатуры

### Масштабирование

- **Изменение размера вручную**: Потяните за углы или края окна для изменения размера
- **Полноэкранный режим**: Нажмите кнопку ⛶ в правом верхнем углу для растягивания на весь экран
- **Автоматическое масштабирование**: Шрифты автоматически увеличиваются/уменьшаются при изменении размера окна

### Переключение раскладки

- Просто переключите раскладку в системе (Alt+Shift или другая комбинация)
- Виртуальная клавиатура автоматически синхронизируется с системной раскладкой
- Цвет заголовка меняется: синий для EN, красный для RU

### Работа с Caps Lock

- Caps Lock синхронизируется с системным состоянием при запуске программы
- При нажатии Caps Lock программа автоматически определяет новое состояние
- При переключении раскладки состояние Caps Lock сохраняется
- Логика работы: `Caps Lock XOR Shift` для определения регистра

## Требования

- Python 3.7+
- tkinter (обычно входит в стандартную установку Python)
- pynput

Установка зависимостей:

```bash
pip install pynput
```

## Примечание

⚠️ Использование программ отслеживания клавиш может регулироваться законодательством.
Используйте эту программу только на своем компьютере и для обучения.

## Возможности расширения

Вы можете модифицировать программу для:

- Сохранения нажатий в файл
- Подсчета статистики нажатий
- Фильтрации определенных клавиш
- Создания горячих клавиш
- Добавления поддержки других языков